<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORTEX CINEMA</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Space+Mono:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Orbitron', monospace;
            background: radial-gradient(circle at 50% 50%, #ff006e, #8338ec, #3a86ff, #06ffa5);
            background-size: 300% 300%;
            animation: psychedelicShift 8s ease-in-out infinite;
            overflow-x: hidden;
            color: white;
            min-height: 100vh;
        }
        
        @keyframes psychedelicShift {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 0%; }
            50% { background-position: 50% 100%; }
            75% { background-position: 0% 0%; }
        }
        
        .fractal-border {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            border: 8px solid;
            border-image: linear-gradient(45deg, #ff006e, #8338ec, #3a86ff, #06ffa5, #ff006e) 1;
            animation: borderPulse 3s ease-in-out infinite;
            z-index: 1000;
        }
        
        @keyframes borderPulse {
            0%, 100% { border-width: 8px; opacity: 0.8; }
            50% { border-width: 16px; opacity: 1; }
        }
        
        .mandala-bg {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80vmin;
            height: 80vmin;
            background: radial-gradient(circle, transparent 20%, rgba(255, 0, 110, 0.1) 40%, transparent 60%);
            border-radius: 50%;
            animation: mandalaRotate 20s linear infinite;
            z-index: -1;
        }
        
        @keyframes mandalaRotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        .lava-edge {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255, 0, 110, 0.3), rgba(131, 56, 236, 0.3));
            clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
            animation: lavaFlow 6s ease-in-out infinite;
        }
        
        @keyframes lavaFlow {
            0%, 100% { clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%); }
            50% { clip-path: polygon(5% 0, 95% 0, 100% 100%, 0% 100%); }
        }
        
        .container {
            position: relative;
            z-index: 10;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .title {
            font-size: clamp(2rem, 8vw, 6rem);
            font-weight: 900;
            text-align: center;
            margin-bottom: 2rem;
            background: linear-gradient(45deg, #ff006e, #8338ec, #3a86ff, #06ffa5);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: titleMelt 4s ease-in-out infinite, textShimmer 2s linear infinite;
            text-shadow: 0 0 20px rgba(255, 0, 110, 0.5);
        }
        
        @keyframes titleMelt {
            0%, 100% { transform: skew(0deg, 0deg) scale(1); }
            25% { transform: skew(-2deg, 1deg) scale(1.02); }
            50% { transform: skew(2deg, -1deg) scale(0.98); }
            75% { transform: skew(-1deg, 2deg) scale(1.01); }
        }
        
        @keyframes textShimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .neural-display {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            max-width: 800px;
            width: 100%;
            border: 2px solid rgba(255, 0, 110, 0.5);
            backdrop-filter: blur(10px);
            animation: displayGlow 3s ease-in-out infinite;
        }
        
        @keyframes displayGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 0, 110, 0.3); }
            50% { box-shadow: 0 0 40px rgba(131, 56, 236, 0.5); }
        }
        
        .fragment-text {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            animation: textWarp 5s ease-in-out infinite;
            font-family: 'Space Mono', monospace;
        }
        
        @keyframes textWarp {
            0%, 100% { transform: perspective(500px) rotateX(0deg); }
            50% { transform: perspective(500px) rotateX(2deg); }
        }
        
        .choice-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            width: 100%;
            max-width: 600px;
        }
        
        .choice-btn {
            background: linear-gradient(45deg, rgba(255, 0, 110, 0.8), rgba(131, 56, 236, 0.8));
            border: none;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-family: 'Orbitron', monospace;
            color: white;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .choice-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }
        
        .choice-btn:hover:before {
            left: 100%;
        }
        
        .choice-btn:hover {
            transform: scale(1.05) rotate(1deg);
            box-shadow: 0 10px 30px rgba(255, 0, 110, 0.4);
        }
        
        .choice-btn:active {
            transform: scale(0.95);
        }
        
        .audio-visualizer {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 3px;
            z-index: 100;
        }
        
        .audio-bar {
            width: 4px;
            background: linear-gradient(to top, #ff006e, #06ffa5);
            border-radius: 2px;
            animation: audioWave 1.5s ease-in-out infinite;
        }
        
        .audio-bar:nth-child(1) { height: 20px; animation-delay: 0s; }
        .audio-bar:nth-child(2) { height: 35px; animation-delay: 0.1s; }
        .audio-bar:nth-child(3) { height: 25px; animation-delay: 0.2s; }
        .audio-bar:nth-child(4) { height: 40px; animation-delay: 0.3s; }
        .audio-bar:nth-child(5) { height: 30px; animation-delay: 0.4s; }
        .audio-bar:nth-child(6) { height: 45px; animation-delay: 0.5s; }
        
        @keyframes audioWave {
            0%, 100% { transform: scaleY(0.3); opacity: 0.7; }
            50% { transform: scaleY(1); opacity: 1; }
        }
        
        .memory-splice {
            position: absolute;
            top: 10%;
            right: 10%;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(255, 0, 110, 0.6), transparent);
            border-radius: 50%;
            animation: memorySplice 3s ease-in-out infinite;
        }
        
        @keyframes memorySplice {
            0%, 100% { transform: scale(0.8) rotate(0deg); opacity: 0.6; }
            50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
        }
        
        .projection-status {
            position: fixed;
            top: 20px;
            left: 20px;
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 15px;
            border-radius: 10px;
            border: 1px solid rgba(58, 134, 255, 0.5);
            animation: statusBlink 2s ease-in-out infinite;
        }
        
        @keyframes statusBlink {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        .glitch-effect {
            animation: glitch 0.3s ease-in-out infinite;
        }
        
        @keyframes glitch {
            0%, 100% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
        }
    </style>
</head>
<body>
    <div class="fractal-border"></div>
    <div class="mandala-bg"></div>
    <div class="lava-edge"></div>
    <div class="memory-splice"></div>
    
    <div class="projection-status">
        NEURAL PROJECTION: <span id="status">ACTIVE</span>
    </div>
    
    <div class="audio-visualizer">
        <div class="audio-bar"></div>
        <div class="audio-bar"></div>
        <div class="audio-bar"></div>
        <div class="audio-bar"></div>
        <div class="audio-bar"></div>
        <div class="audio-bar"></div>
    </div>
    
    <div class="container">
        <div id="start-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; z-index: 2000; cursor: pointer;" onclick="startExperience()">
            <div style="text-align: center; color: white; font-family: 'Orbitron', monospace;">
                <h2 style="font-size: 2rem; margin-bottom: 1rem; background: linear-gradient(45deg, #ff006e, #06ffa5); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">INITIALIZE NEURAL PROJECTION</h2>
                <p style="font-size: 1.2rem; opacity: 0.8;">Click to enter the psychedelic soundscape</p>
                <div style="margin-top: 2rem; font-size: 3rem; animation: titleMelt 2s ease-in-out infinite;">▶</div>
            </div>
        </div>
        
        <h1 class="title">CORTEX CINEMA</h1>
        
        <div class="neural-display">
            <div class="fragment-text" id="narrative-text">
                You drift through the phosphorescent void of the neural projection device. Reality fragments cascade around you like liquid television static. The multilingual narrator whispers in seventeen languages simultaneously: "Welcome to the space between thoughts, where media memories bleed into one another..."
            </div>
            
            <div class="choice-container" id="choices">
                <button class="choice-btn" onclick="makeChoice(1)">
                    DIVE INTO THE NEON MEMORY STREAM
                </button>
                <button class="choice-btn" onclick="makeChoice(2)">
                    SURFACE THROUGH THE ANALOG DREAMS
                </button>
                <button class="choice-btn" onclick="makeChoice(3)">
                    FRACTURE THE NARRATIVE CONSTRUCT
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentScene = 0;
        let glitchActive = false;
        let audioContext;
        let masterGain;
        let synthOscillators = [];
        let isPlaying = false;
        
        // Initialize Web Audio API
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                masterGain = audioContext.createGain();
                masterGain.connect(audioContext.destination);
                masterGain.gain.setValueAtTime(0.3, audioContext.currentTime);
                
                startAmbientSoundtrack();
            } catch (e) {
                console.log('Audio not supported');
            }
        }
        
        // Create psychedelic ambient soundtrack
        function startAmbientSoundtrack() {
            if (!audioContext || isPlaying) return;
            isPlaying = true;
            
            // Deep bass drone
            const bassOsc = audioContext.createOscillator();
            const bassGain = audioContext.createGain();
            const bassFilter = audioContext.createBiquadFilter();
            
            bassOsc.type = 'sawtooth';
            bassOsc.frequency.setValueAtTime(45, audioContext.currentTime);
            bassFilter.type = 'lowpass';
            bassFilter.frequency.setValueAtTime(120, audioContext.currentTime);
            bassGain.gain.setValueAtTime(0.4, audioContext.currentTime);
            
            bassOsc.connect(bassFilter);
            bassFilter.connect(bassGain);
            bassGain.connect(masterGain);
            bassOsc.start();
            synthOscillators.push(bassOsc);
            
            // Modulate bass frequency for psychedelic effect
            const bassLFO = audioContext.createOscillator();
            const bassLFOGain = audioContext.createGain();
            bassLFO.type = 'sine';
            bassLFO.frequency.setValueAtTime(0.1, audioContext.currentTime);
            bassLFOGain.gain.setValueAtTime(5, audioContext.currentTime);
            bassLFO.connect(bassLFOGain);
            bassLFOGain.connect(bassOsc.frequency);
            bassLFO.start();
            synthOscillators.push(bassLFO);
            
            // Ethereal pad layer
            createPadLayer(220, 0.15, 'triangle', 0.05);
            createPadLayer(330, 0.12, 'sine', 0.08);
            createPadLayer(440, 0.1, 'sawtooth', 0.12);
            
            // Ambient texture layer
            setTimeout(() => createTextureLayer(), 2000);
            setTimeout(() => createArpeggioLayer(), 5000);
        }
        
        function createPadLayer(baseFreq, volume, waveType, lfoSpeed) {
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            const filter = audioContext.createBiquadFilter();
            const reverb = createReverb();
            
            osc.type = waveType;
            osc.frequency.setValueAtTime(baseFreq, audioContext.currentTime);
            
            filter.type = 'lowpass';
            filter.frequency.setValueAtTime(800 + Math.random() * 400, audioContext.currentTime);
            filter.Q.setValueAtTime(2, audioContext.currentTime);
            
            gain.gain.setValueAtTime(0, audioContext.currentTime);
            gain.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 3);
            
            // LFO for frequency modulation
            const lfo = audioContext.createOscillator();
            const lfoGain = audioContext.createGain();
            lfo.type = 'sine';
            lfo.frequency.setValueAtTime(lfoSpeed, audioContext.currentTime);
            lfoGain.gain.setValueAtTime(8, audioContext.currentTime);
            lfo.connect(lfoGain);
            lfoGain.connect(osc.frequency);
            lfo.start();
            
            osc.connect(filter);
            filter.connect(gain);
            gain.connect(reverb);
            reverb.connect(masterGain);
            osc.start();
            
            synthOscillators.push(osc, lfo);
        }
        
        function createTextureLayer() {
            // Create noise-based texture
            const bufferSize = audioContext.sampleRate * 2;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const data = buffer.getChannelData(0);
            
            for (let i = 0; i < bufferSize; i++) {
                data[i] = (Math.random() * 2 - 1) * 0.1;
            }
            
            const noise = audioContext.createBufferSource();
            const noiseGain = audioContext.createGain();
            const noiseFilter = audioContext.createBiquadFilter();
            
            noise.buffer = buffer;
            noise.loop = true;
            
            noiseFilter.type = 'bandpass';
            noiseFilter.frequency.setValueAtTime(400, audioContext.currentTime);
            noiseFilter.Q.setValueAtTime(10, audioContext.currentTime);
            
            noiseGain.gain.setValueAtTime(0.05, audioContext.currentTime);
            
            noise.connect(noiseFilter);
            noiseFilter.connect(noiseGain);
            noiseGain.connect(masterGain);
            noise.start();
            
            // Modulate filter frequency
            const filterLFO = audioContext.createOscillator();
            const filterLFOGain = audioContext.createGain();
            filterLFO.type = 'sine';
            filterLFO.frequency.setValueAtTime(0.03, audioContext.currentTime);
            filterLFOGain.gain.setValueAtTime(200, audioContext.currentTime);
            filterLFO.connect(filterLFOGain);
            filterLFOGain.connect(noiseFilter.frequency);
            filterLFO.start();
        }
        
        function createArpeggioLayer() {
            const notes = [220, 277, 330, 415, 554, 415, 330, 277];
            let noteIndex = 0;
            
            function playArpNote() {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                const filter = audioContext.createBiquadFilter();
                const delay = createDelay();
                
                osc.type = 'sine';
                osc.frequency.setValueAtTime(notes[noteIndex], audioContext.currentTime);
                
                filter.type = 'lowpass';
                filter.frequency.setValueAtTime(1200, audioContext.currentTime);
                
                gain.gain.setValueAtTime(0, audioContext.currentTime);
                gain.gain.linearRampToValueAtTime(0.08, audioContext.currentTime + 0.05);
                gain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 1.5);
                
                osc.connect(filter);
                filter.connect(gain);
                gain.connect(delay);
                delay.connect(masterGain);
                
                osc.start();
                osc.stop(audioContext.currentTime + 2);
                
                noteIndex = (noteIndex + 1) % notes.length;
                
                setTimeout(playArpNote, 800 + Math.random() * 400);
            }
            
            playArpNote();
        }
        
        function createReverb() {
            const convolver = audioContext.createConvolver();
            const bufferSize = audioContext.sampleRate * 3;
            const buffer = audioContext.createBuffer(2, bufferSize, audioContext.sampleRate);
            
            for (let channel = 0; channel < 2; channel++) {
                const data = buffer.getChannelData(channel);
                for (let i = 0; i < bufferSize; i++) {
                    data[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / bufferSize, 2);
                }
            }
            
            convolver.buffer = buffer;
            return convolver;
        }
        
        function createDelay() {
            const delay = audioContext.createDelay(1);
            const feedback = audioContext.createGain();
            const delayGain = audioContext.createGain();
            
            delay.delayTime.setValueAtTime(0.3, audioContext.currentTime);
            feedback.gain.setValueAtTime(0.4, audioContext.currentTime);
            delayGain.gain.setValueAtTime(0.3, audioContext.currentTime);
            
            delay.connect(feedback);
            feedback.connect(delay);
            delay.connect(delayGain);
            
            return delayGain;
        }
        
        // Sound effects
        function playSelectSound() {
            if (!audioContext) return;
            
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            const filter = audioContext.createBiquadFilter();
            
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioContext.currentTime);
            osc.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.2);
            
            filter.type = 'lowpass';
            filter.frequency.setValueAtTime(1200, audioContext.currentTime);
            
            gain.gain.setValueAtTime(0.2, audioContext.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.3);
            
            osc.connect(filter);
            filter.connect(gain);
            gain.connect(masterGain);
            
            osc.start();
            osc.stop(audioContext.currentTime + 0.3);
            
            // Visual feedback
            const visualizer = document.querySelector('.audio-visualizer');
            visualizer.style.transform = 'scale(1.2)';
            
            setTimeout(() => {
                visualizer.style.transform = 'scale(1)';
            }, 200);
        }
        
        function playGlitchSound() {
            if (!audioContext) return;
            
            // Create glitch-like sound
            const noise = audioContext.createBufferSource();
            const bufferSize = audioContext.sampleRate * 0.1;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const data = buffer.getChannelData(0);
            
            for (let i = 0; i < bufferSize; i++) {
                data[i] = (Math.random() * 2 - 1) * 0.3;
            }
            
            noise.buffer = buffer;
            
            const gain = audioContext.createGain();
            const filter = audioContext.createBiquadFilter();
            
            filter.type = 'bandpass';
            filter.frequency.setValueAtTime(2000 + Math.random() * 1000, audioContext.currentTime);
            filter.Q.setValueAtTime(10, audioContext.currentTime);
            
            gain.gain.setValueAtTime(0.15, audioContext.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.1);
            
            noise.connect(filter);
            filter.connect(gain);
            gain.connect(masterGain);
            noise.start();
        }
        
        function playTransitionSound() {
            if (!audioContext) return;
            
            // Reverse guitar-like effect
            const osc1 = audioContext.createOscillator();
            const osc2 = audioContext.createOscillator();
            const gain = audioContext.createGain();
            const filter = audioContext.createBiquadFilter();
            const delay = createDelay();
            
            osc1.type = 'sawtooth';
            osc1.frequency.setValueAtTime(110, audioContext.currentTime);
            osc1.frequency.exponentialRampToValueAtTime(55, audioContext.currentTime + 1);
            
            osc2.type = 'triangle';
            osc2.frequency.setValueAtTime(220, audioContext.currentTime);
            osc2.frequency.exponentialRampToValueAtTime(110, audioContext.currentTime + 1);
            
            filter.type = 'lowpass';
            filter.frequency.setValueAtTime(400, audioContext.currentTime);
            filter.frequency.linearRampToValueAtTime(800, audioContext.currentTime + 0.5);
            filter.frequency.linearRampToValueAtTime(200, audioContext.currentTime + 1);
            
            gain.gain.setValueAtTime(0, audioContext.currentTime);
            gain.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.1);
            gain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 1.2);
            
            osc1.connect(gain);
            osc2.connect(gain);
            gain.connect(filter);
            filter.connect(delay);
            delay.connect(masterGain);
            
            osc1.start();
            osc2.start();
            osc1.stop(audioContext.currentTime + 1.5);
            osc2.stop(audioContext.currentTime + 1.5);
        }
        
        const scenes = [
            {
                text: "You drift through the phosphorescent void of the neural projection device. Reality fragments cascade around you like liquid television static. The multilingual narrator whispers in seventeen languages simultaneously: \"Welcome to the space between thoughts, where media memories bleed into one another...\"",
                choices: [
                    "DIVE INTO THE NEON MEMORY STREAM",
                    "SURFACE THROUGH THE ANALOG DREAMS", 
                    "FRACTURE THE NARRATIVE CONSTRUCT"
                ]
            },
            {
                text: "The neon stream engulfs you in electric magenta. Childhood cartoons melt with abstract expressionist paintings. A voice speaks in reverse Spanish: \"La realidad es una ilusión compartida.\" You feel your consciousness dissolving into pure color and sound...",
                choices: [
                    "MERGE WITH THE CARTOON CONSCIOUSNESS",
                    "RESIST THE DISSOLUTION",
                    "BECOME THE COLOR ITSELF"
                ]
            },
            {
                text: "Analog static fills your vision as you rise through layers of vintage film grain. A symphony of tape rewinds echoes through your neural pathways. The narrator, now speaking in fragmented French and Japanese, guides you through a museum of forgotten dreams...",
                choices: [
                    "ENTER THE MUSEUM OF LOST MOMENTS",
                    "REWIND TO THE SOURCE SIGNAL",
                    "FAST FORWARD TO THE FUTURE ECHO"
                ]
            },
            {
                text: "Reality shatters like a broken mirror, each shard reflecting a different story. You become the narrator, the audience, and the projection itself. The boundaries between observer and observed collapse into infinite recursive loops of meaning...",
                choices: [
                    "EMBRACE THE RECURSIVE INFINITY",
                    "SEEK THE ORIGINAL NARRATIVE",
                    "CREATE A NEW STORY FRAGMENT"
                ]
            },
            {
                text: "You merge with the animated essence, becoming one with hand-drawn souls and digital spirits. Your thoughts now flow in 24 frames per second. Every blink is a scene transition, every breath a fade to black...",
                choices: [
                    "ANIMATE YOUR OWN EXISTENCE",
                    "FIND THE ANIMATOR'S HAND",
                    "BREAK THE FOURTH WALL"
                ]
            },
            {
                text: "Fighting against the current, you maintain your form while reality liquefies around you. The narrator applauds in binary code: \"01000010 01110010 01100001 01110110 01101111.\" You stand as an island of consciousness in an ocean of pure experience...",
                choices: [
                    "BUILD A BRIDGE TO OTHER ISLANDS",
                    "DIVE BENEATH THE SURFACE",
                    "SIGNAL FOR RESCUE"
                ]
            }
        ];
        
        function makeChoice(choiceNum) {
            playSelectSound();
            playTransitionSound();
            
            if (Math.random() < 0.3) {
                triggerGlitch();
            }
            
            currentScene = (currentScene + choiceNum) % scenes.length;
            updateScene();
        }
        
        function updateScene() {
            const textElement = document.getElementById('narrative-text');
            const choicesElement = document.getElementById('choices');
            
            // Typewriter effect
            textElement.innerHTML = '';
            const text = scenes[currentScene].text;
            let i = 0;
            
            function typeWriter() {
                if (i < text.length) {
                    textElement.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(typeWriter, 30 + Math.random() * 20);
                } else {
                    updateChoices();
                }
            }
            
            typeWriter();
        }
        
        function updateChoices() {
            const choicesElement = document.getElementById('choices');
            choicesElement.innerHTML = '';
            
            scenes[currentScene].choices.forEach((choice, index) => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.textContent = choice;
                btn.onclick = () => makeChoice(index + 1);
                choicesElement.appendChild(btn);
                
                // Stagger the button appearances
                setTimeout(() => {
                    btn.style.opacity = '1';
                    btn.style.transform = 'translateY(0)';
                }, index * 200);
                
                btn.style.opacity = '0';
                btn.style.transform = 'translateY(20px)';
                btn.style.transition = 'all 0.5s ease';
            });
        }
        
        function triggerGlitch() {
            if (glitchActive) return;
            
            glitchActive = true;
            playGlitchSound();
            
            const container = document.querySelector('.container');
            container.classList.add('glitch-effect');
            
            // Random glitch sounds simulation
            const status = document.getElementById('status');
            const originalText = status.textContent;
            
            const glitchTexts = ['ERR0R', '∆SYNC', '█▓▒░', 'NULL', 'VOID'];
            let glitchCount = 0;
            
            const glitchInterval = setInterval(() => {
                status.textContent = glitchTexts[Math.floor(Math.random() * glitchTexts.length)];
                glitchCount++;
                
                if (glitchCount > 5) {
                    clearInterval(glitchInterval);
                    status.textContent = originalText;
                    container.classList.remove('glitch-effect');
                    glitchActive = false;
                }
            }, 100);
        }
        
        function playSelectSound() {
            // Simulate audio feedback with visual response
            const visualizer = document.querySelector('.audio-visualizer');
            visualizer.style.transform = 'scale(1.2)';
            
            setTimeout(() => {
                visualizer.style.transform = 'scale(1)';
            }, 200);
        }
        
        // Click to start audio (required by browsers)
        function startExperience() {
            initAudio();
            document.getElementById('start-overlay').style.display = 'none';
        }
        
        // Random environmental effects
        setInterval(() => {
            if (Math.random() < 0.1) {
                triggerGlitch();
            }
        }, 10000);
        
        // Status text rotation
        const statusTexts = ['ACTIVE', 'SYNCED', 'LINKED', 'DEEP', 'FLOW'];
        let statusIndex = 0;
        
        setInterval(() => {
            const status = document.getElementById('status');
            statusIndex = (statusIndex + 1) % statusTexts.length;
            status.textContent = statusTexts[statusIndex];
        }, 3000);
        
        // Initialize with smooth transitions
        document.addEventListener('DOMContentLoaded', () => {
            updateChoices();
        });
    </script>
</body>
</html>